# Ресторан "Saphir" - сайт ресторана направлен на удобное бронирование столов для посетителей


# Структура

Структура данного проекта следующая:
1. Директория config, в ней представлены все необходимые настройки проекта.
2. Папка media, в ней были представлены изображения формата jpg. Цель изображений правильно отобразить страницы сайта.
3. Директория restaurant, директория на которой и построен сайт ресторана "Saphir", что по совместительству и является приложением.
4. Папка static для отображения статических файлов на страницах сайта, а также для хранения css файлов и js файлов.
5. Директория users, является приложением для пользователя и содержит часть функциональности для создания и возможности редактировать.
6. .env.example - вложены все необходимые переменные
7. .gitignore - для игнорирования файлов при коммите.
8. docker-compose.yaml - используется для описания всех сервисов, сетей и томов.
9. Dockerfile - для сборки docker-образа из текущего проекта.
10. manage.py — это скрипт командной строки, созданный Django.
11. poetry.lock и poetry.toml - файлы необходимые Poetry для управления зависимостями проекта.

# Стек

- Предназначен для реализации проекта и использует фреймворк Django.
- Данные хранятся в PostgreSQL.
- Интерфейс создан с использованием Bootstrap и custom.css.
- Использован Docker и Docker-compose для контейнеризации проекта.
- Celery и Celery Beat для работы  в рознь некоторых функций проекта.
- Redis для корректной работы Celery и Celery Beat, а также для хранения кэшированных шаблонов.

# Использование с помощью docker-compose

1. Клонируйте репозиторий
```
git@github.com:Lex0104/saphir_diplom.git
```

2. Поскольку проект использует Docker, необходимо установить [Docker](https://www.docker.com/products/docker-desktop/)
3. Откройте скопированный проект.
4. Переименуйте файл '.env.smple' в '.env' и внесите необходимые данные переменных окружения
5. Запустите проект командой: ```docker-compose up -d --build```
6. Для остановки всех контейнеров и их удаления используйте команду ```docker-compose down```


# Проверка работоспособности

1. Общая проверка:
   - Для общей проверки с использованием docker-compose можно воспользоваться командой ```docker-compose logs -f```.
   - Для проверки каждого из сервисов с использованием docker-compose можно использовать команду ```docker-compose logs
2. Проверка по отдельности:
    - Для проверки сервиса 'web' достаточно перейти на страницу сервера или выполнить запрос в Postman или другой программе
    - Для проверки сервиса 'db' можно ввести команду ```docker exec -it <db_container_id> psql -U <username>```. db_container_id можно получить командой ```docker ps```
    - Для проверки сервиса 'redis' введите команду ```docker-compose exec redis redis-cli ping```. Если в терминале получаем ответ 'PONG', значит сервис работает
    - Для проверки сервиса 'celery' введите команду ```docker-compose exec celery poetry run python manage.py shell -c "from restaurant.tasks import check_reservation; check_reservation()"```
    - Для проверки сервиса 'celery-beat' достаточно проверить логи командой ```docker-compose logs celery-beat``` и убедиться, что beat scheduler запущен (-beat: Starting // -Scheduler: Sending due task...)

